# 全国IPTV直播流代理 - EdgeOne Pages部署项目

基于Next.js的全国各地电视台直播代理服务,可部署到腾讯云EdgeOne Pages。

## 支持的电视台

### 🎬 4K频道 (9个)
- 北京卫视4K (btv4k)
- 上海卫视4K (sh4k)
- 江苏卫视4K (js4k)
- 浙江卫视4K (zj4k)
- 山东卫视4K (sd4k)
- 湖南卫视4K (hn4k)
- 广东卫视4K (gd4k)
- 四川卫视4K (sc4k)
- 深圳卫视4K (sz4k)

### 📺 北京TV (10个)
- 北京卫视 (bjws)
- BRTV文艺 (bjwy)
- BRTV纪实科教 (bjjskj)
- BRTV影视 (bjys)
- BRTV财经 (bjcj)
- BRTV生活 (bjsh)
- BRTV新闻 (bjxw)
- 卡酷少儿 (bjkk)
- 北京卫视4K (bjws4k)
- BRTV体育休闲 (bjty)

### 📺 河南TV (17个)
- 河南卫视 (hnws)
- 河南都市 (hnds)
- 河南民生 (hnms)
- 河南法治 (hmfz)
- 河南电视剧 (hndsj)
- 河南新闻 (hnxw)
- 欢腾购物 (htgw)
- 河南公共 (hngg)
- 河南乡村 (hnxc)
- 河南国际 (hngj)
- 河南梨园 (hnly)
- 文物宝库 (wwbk)
- 武术世界 (wspd)
- 睛彩中原 (jczy)
- 移动戏曲 (ydxj)
- 象视界 (xsj)
- 国学频道 (gxpd)

### 📺 河北TV (8个)
- 河北卫视 (hbws)
- 经济生活 (hbjj)
- 三农频道 (nmpd)
- 河北都市 (hbds)
- 河北影视剧 (hbys)
- 少儿科教 (hbse)
- 文旅·公共 (hbgg)
- 三佳购物 (hbsj)

### 📺 江苏TV (50个)
- 江苏卫视 (jsws)
- 江苏城市 (jscs)
- 江苏综艺 (jszy)
- 江苏影视 (jsys)
- 江苏新闻 (jsxw)
- 江苏教育 (jsjy)
- 江苏体育休闲 (jsty)
- 江苏国际 (jsgj)
- 优漫卡通 (ymkt)
- 南京新闻综合 (nj1)
- 六合新闻综合 (njlh)
- 无锡新闻综合 (wx1)
- 江阴新闻综合 (wxjy)
- 徐州新闻综合 (xz1)
- 邳州综合 (xzpz)
- 新沂新闻综合 (xzxy)
- 贾汪新闻综合 (xzjw)
- 铜山新闻综合 (xzts)
- 常州新闻 (cz1)
- 武进综合 (czwj)
- 苏州新闻综合 (sz1)
- 常熟综合 (szcs)
- 吴江新闻综合 (szwj)
- 张家港新闻综合 (szzjg)
- 南通新闻综合 (nt1)
- 连云港新闻综合 (lyg1)
- 东海新闻综合 (lygdh)
- 淮安综合 (ha1)
- 盱眙综合 (haxy)
- 洪泽综合 (hahz)
- 盐城1套 (yc1)
- 响水综合 (ycxs)
- 扬州新闻 (yz1)
- 邗江综合 (yzhj)
- 镇江新闻综合 (zj1)
- 句容新闻综合 (zjjr)
- 泰州新闻 (tz1)
- 靖江新闻 (tzjj)
- 泰兴新闻综合 (tztx)
- 兴化新闻综合 (tzxh)
- 宿迁综合 (sq1)
- 泗阳综合 (sqsy)

### 📺 山东TV (26个)
- 山东卫视 (sdws)
- 新闻频道 (xwpd)
- 齐鲁频道 (qlpd)
- 体育休闲频道 (txyx)
- 生活频道 (shpd)
- 综艺频道 (zypd)
- 文旅频道 (wlpd)
- 农科频道 (nkpd)
- 少儿频道 (sepd)
- 济南台 (jndst)
- 淄博台 (zbdst)
- 枣庄台 (zzdst)
- 东营台 (dydst)
- 烟台台 (ytdst)
- 潍坊台 (wfdst)
- 泰安台 (tadst)
- 威海台 (whdst)
- 日照台 (rzdst)
- 临沂台 (lydst)
- 德州台 (dzdst)
- 聊城台 (lcdst)
- 滨州台 (bzdst)
- 菏泽台 (hzdst)
- 济宁台 (jxdst)
- 莱芜台 (lzdst)
- 章丘台 (zcdst)

### 📺 陕西TV (17个)
- 农林卫视 (1126)
- 新闻资讯 (1127)
- 都市青春 (1128)
- 银龄频道 (1129)
- 秦腔频道 (1130)
- 陕西卫视 (1131)
- 体育休闲 (1179)
- 乐家购物 (1241)
- 移动电视 (1242)
- 新闻广播 (2134)
- 汽车调频 (2135)
- 交通广播 (2136)
- 音乐广播 (2137)
- 都市广播 (2139)
- 青少广播 (2140)
- 戏曲广播 (2142)
- 农村广播 (2143)

### 📺 深圳TV (11个)
- 深圳卫视4K (szws4k)
- 深圳卫视 (szws)
- 都市频道 (szds)
- 电视剧频道 (szdsj)
- 公共频道 (szgg)
- 财经频道 (szcj)
- 娱乐生活 (szyl)
- 少儿频道 (szse)
- 移动电视 (szyd)
- 宜和购物频道 (szyh)
- 国际频道 (szgj)

### 📺 石家庄TV (动态)
- 频道列表实时同步API
- 请访问 /api/sjz?id=list 获取最新频道

### 📺 云南TV (6个)
- 云南卫视 (ynws)
- 云南都市 (ynds)
- 云南娱乐 (ynyl)
- 云南公共 (yngg)
- 云南国际 (yngj)
- 云南少儿 (ynse)

### 📺 浙江TV (38个)
- 杭州萧山综合 (hzxs1)
- 象山新闻综合 (xsxwzh)
- 温州苍南新闻综合 (wzcn1)
- 温州永嘉新闻综合 (wzyj1)
- 温州电视台 (wzdt1)
- 瑞安新闻综合 (raxwzh)
- 柯桥新闻综合 (kqxwzh)
- 金华东阳影视生活 (jhdy2)
- 金华磐安新闻综合 (jhpa1)
- 金华磐安文化旅游 (jhpa2)
- 金华永康新闻综合 (jhyk1)
- 金华永康华溪频道 (jhyk2)
- 嵊州新闻综合 (szxwzh)
- 台州天台和合频道 (tztt1)
- 台州玉环新闻综合 (tzyh1)
- 嘉兴新闻综合 (jxxwzh)
- 嘉兴文化旅游 (jxwhly)
- 嘉兴公共 (jxgg)
- 丽水龙泉新闻综合 (lslq1)
- 丽水松阳新闻综合 (lssy1)
- 丽水云和新闻综合 (lsyh1)
- 丽水庆元电视台 (lsqy1)
- 平湖综合 (phzh)
- 衢州常山新闻综合 (qzcs1)
- 衢州开化综合 (qzkh1)
- 东阳新闻综合 (dyxwzh)
- 东阳影视生活 (dyyssh)
- 武义新闻综合 (wyxwzh)
- 景宁电视台 (jndst)
- 青田电视台 (qtdst)
- 舟山普陀新闻综合 (zspt1)
- 遂昌电视台 (scdst)
- 舟山新闻综合 (zsxwzh)
- 舟山公共 (zsgg)
- 宁波余姚姚江文化 (nbyy2)
- 江山电视台 (jsdst)
- 龙游新闻综合 (lyxwzh)
- 衢江新闻综合 (xwzh5)

### 📺 上海TV (8个)
- 东方卫视4k (dfws)
- 上海新闻综合 (shxwzh)
- 上海都市 (shds)
- 第一财经 (dycj)
- 哈哈炫动 (hhxd)
- 五星体育 (wxty)
- 上海魔都眼 (mdy)
- 上海新纪实 (jsrw)

### 📺 广州TV (4个)
- 广州综合 (gzzh)
- 广州新闻 (gzxw)
- 南国都市（4K） (ngds)
- 广州法治 (gzzf)

### 📺 南京 (5个)
- 新闻综合频道 (109152)
- 教育科技频道 (109153)
- 十八·生活频道 (110094)
- 文旅纪录频道 (110093)
- 少儿频道 (110095)

### 📺 广东 (20个)
- 广东卫视 (43)
- 广东珠江 (44)
- 广东新闻 (45)
- 大湾区卫视 (46)
- 广东体育 (47)
- 广东民生 (48)
- 大湾区卫视 (51)
- 广东影视 (53)
- 广东4K (16)
- 广东少儿 (54)
- 嘉佳卡通 (66)
- 南方购物 (42)
- 岭南戏曲 (15)
- 广东移动 (74)
- 现代教育 (111)
- 广东台经典剧 (100)
- 广东纪录片 (94)
- GRTN健康频道 (99)
- GRTN文化频道 (75)
- GRTN生活频道 (102)

## 功能特性

- ✅ 支持全国多地电视台频道
- ✅ M3U8播放列表代理
- ✅ TS文件自动代理
- ✅ Edge Runtime运行
- ✅ 无需服务器,直接部署到EdgeOne
- ✅ 统一API接口设计
- ✅ TypeScript类型安全

## API使用

### 通用格式

```bash
# 获取M3U8播放列表
https://your-domain.com/api/{region}?id={channel_id}

# 示例
https://your-domain.com/api/yunnan?id=ynws      # 云南卫视
https://your-domain.com/api/beijing?id=bjws     # 北京卫视
https://your-domain.com/api/4k?id=btv4k         # 北京卫视4K
https://your-domain.com/api/sjz?id=list         # 石家庄频道动态列表
```

### 获取M3U8播放列表

```
GET /api/{region}?id={channel_id}
```

示例:
```
# 云南卫视
https://your-domain.com/api/yunnan?id=ynws

# 北京卫视4K
https://your-domain.com/api/4k?id=btv4k

# 北京卫视
https://your-domain.com/api/beijing?id=bjws

# 石家庄频道列表（动态）
https://your-domain.com/api/sjz?id=list
```

### 播放器使用

```m3u
#EXTM3U
#EXTINF:-1,北京卫视4K
https://your-domain.com/api/4k?id=btv4k
#EXTINF:-1,北京卫视
https://your-domain.com/api/beijing?id=bjws
#EXTINF:-1,云南卫视
https://your-domain.com/api/yunnan?id=ynws
#EXTINF:-1,石家庄频道（动态）
https://your-domain.com/api/sjz?id=list
```
 
## 本地开发

如需在本地调试和开发项目，请参考以下步骤（适用于 Node 18+）：

1. 安装依赖

```bash
npm install
```

2. 本地开发（热重载）

```bash
npm run dev
```

3. 生产构建与启动

```bash
npm run build
npm run start
```

访问: http://localhost:3000

更多本地开发注意事项请参见 `DEPLOY.md`。

## 本地 Docker 部署

项目包含用于本地容器化测试的 `Dockerfile`（详见 `DEPLOY.md`）。快速开始：

1. 构建镜像

```bash
docker build -t iptv-edgeone .
```

2. 运行容器（在本地映射为 3000 端口）

```bash
docker run -d \
  --name iptv-edgeone \
  -p 3000:3000 \
  --restart unless-stopped \
  iptv-edgeone
```

容器启动后同样访问: http://localhost:3000

参见 `DEPLOY.md` 以获取 EdgeOne 兼容性、环境变量和调试提示。

## 部署到EdgeOne Pages

1. **准备仓库**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin <your-repo-url>
   git push -u origin main
   ```

2. **EdgeOne Pages配置**
   - 登录腾讯云EdgeOne控制台
   - 创建新站点 → 选择Pages服务
   - 连接GitHub/GitLab仓库
   - 构建配置:
     - 构建命令: `npm run build`
     - 输出目录: `.next`
     - Node版本: 18+

3. **环境变量**
   无需额外配置

4. **部署**
   - 推送代码到仓库自动触发部署
   - 或在控制台手动触发部署

## 项目结构

```
iptv-edgeone/
├── app/
│   ├── api/
│   │   ├── 4k/           # 4K频道API
│   │   ├── beijing/      # 北京台API
│   │   ├── hebei/        # 河北台API
│   │   ├── henan/        # 河南台API
│   │   ├── jiangsu/      # 江苏台API
│   │   ├── shandong/     # 山东台API
│   │   ├── shaanxi/      # 陕西台API
│   │   ├── shenzhen/     # 深圳台API
│   │   ├── sjz/          # 石家庄台API（动态）
│   │   ├── yunnan/       # 云南台API
│   │   └── utils/        # 通用工具函数（如getRealHost）
│   ├── layout.tsx        # 全局布局
│   └── page.tsx          # 首页
├── package.json
├── next.config.js
├── tsconfig.json
├── README.md
└── ...
```

## 原理说明

1. **多地区API分区**：每个地区/频道有独立API目录，便于维护和扩展，上游源获取接口基本都来源于各台官方。
2. **getRealHost工具**：所有API统一通过`getRealHost`获取真实域名，兼容EdgeOne内部转发。
3. **M3U8代理**：API返回标准M3U8播放列表，所有频道URL均为本服务代理，支持VLC等播放器直接播放。
4. **TS文件代理**：如有TS分片，API自动代理并处理防盗链、Referer等。
5. **动态频道支持**：如石家庄频道，API实时抓取上游数据，频道列表随源站变化自动同步。
6. **无状态部署**：所有逻辑基于Edge Runtime，无需本地存储，支持无服务器部署。
7. **TypeScript类型安全**：全项目TypeScript开发，类型安全、易维护。
8. **一键部署**：支持直接部署到腾讯云EdgeOne Pages，自动适配云端环境。

## 性能优化

- Edge Runtime在边缘节点运行,低延迟
- TS文件缓存300秒
- M3U8实时获取,无缓存

## 注意事项

- 仅供学习和个人使用
- 请遵守相关法律法规和版权
- EdgeOne Pages免费额度有限,注意用量

## License

MIT
